<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tyre Analysis System - Enterprise Portal</title>
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .hidden { display: none !important; }
        
        /* Enhanced scrollbar */
        ::-webkit-scrollbar { width: 10px; height: 10px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #cbd5e1 0%, #94a3b8 100%); border-radius: 10px; border: 2px solid #f1f5f9; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(180deg, #94a3b8 0%, #64748b 100%); }
        ::-webkit-scrollbar-thumb:active { background: #2563eb; }

        /* Edit icon styles */
        .edit-icon { cursor: pointer; color: #2563eb; transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); display: inline-flex; align-items: center; justify-content: center; width: 28px; height: 28px; border-radius: 6px; background: transparent; position: relative; }
        .edit-icon:hover { color: white; background: #2563eb; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(37, 99, 235, 0.3); }
        .edit-icon:active { transform: translateY(0); }

        /* Null value styling */
        .row-null { background: #fff1f2; border-left: 3px solid #ef4444; }
        .row-null:hover { background: #ffe4e6; }
        .cell-null { color: #ef4444; font-weight: 600; font-style: italic; }

        /* Status badges */
        .recipe-status-badge { position: absolute; top: 12px; right: 12px; padding: 4px 12px; font-size: 11px; font-weight: 700; border-radius: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
        .recipe-status-completed { background: #d1fae5; color: #065f46; border: 1px solid #10b981; }
        .recipe-status-pending { background: #fef3c7; color: #92400e; border: 1px solid #f59e0b; }
        .status-completed { border-left: 4px solid #10b981; }
        .status-pending { border-left: 4px solid #f59e0b; }

        /* Table styling */
        .parameter-table { font-size: 13px; }
        .parameter-table thead { position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
        .parameter-table th { padding: 14px 16px; font-weight: 700; background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%); text-transform: uppercase; letter-spacing: 0.8px; font-size: 11px; }
        .parameter-table td { padding: 14px 16px; border-bottom: 1px solid #f1f5f9; }
        .parameter-table tbody tr { transition: all 0.2s ease; }
        .parameter-table tbody tr:hover { background: #f8fafc; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04); transform: translateX(2px); }

        /* Inline editing */
        .inline-edit-input { width: 100%; padding: 8px 12px; font-size: 13px; border: 2px solid #2563eb; border-radius: 6px; background: white; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        .inline-edit-input:focus { outline: none; border-color: #1d4ed8; box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.15); }

        /* Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }

        /* --- Analytics Dashboard CSS --- */
        .chart-card { background-color: white; border: 1px solid #d1d5db; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; border-radius: 0.5rem; overflow: hidden; }
        .chart-header { background-color: #f9fafb; border-bottom: 1px solid #e5e7eb; padding: 0.75rem 1rem; text-align: center; }
        .chart-title { font-size: 0.875rem; font-weight: 700; color: #1f2937; }
        .chart-body { padding: 1rem; flex: 1; min-height: 300px; position: relative; }
        .filter-btn { padding: 0.375rem 0.75rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 500; transition-property: background-color, color; transition-duration: 200ms; border: 1px solid transparent; cursor: pointer; }
        .filter-btn-active { background-color: #2563eb; color: white; border-color: #2563eb; }
        .filter-btn-inactive { background-color: #f3f4f6; color: #374151; border-color: #d1d5db; }
        .filter-btn-inactive:hover { background-color: #e5e7eb; }
    </style>
</head>
<body class="font-sans bg-gray-100">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md border-2 border-gray-200">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-600 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <i data-lucide="shield-check" class="w-8 h-8 text-white"></i>
                </div>
                <h1 class="text-3xl font-bold text-gray-800">Tyre Analysis System</h1>
                <p class="text-gray-600 mt-2">Enterprise Quality Control Portal</p>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold mb-2 text-gray-700">Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter username" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2 text-gray-700">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2 text-gray-700">Role</label>
                    <select id="loginRole" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all">
                        <option value="">Select Role</option>
                        <option value="rpscoe">RPSCoE</option>
                        <option value="btp-quality">BTP Quality</option>
                        <option value="btp-technical">BTP Technical</option>
                    </select>
                </div>
                <button onclick="login()" class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white p-3 rounded-lg font-semibold hover:from-blue-700 hover:to-blue-800 transform hover:scale-[1.02] transition-all shadow-lg">LOGIN</button>
                <div class="text-center space-y-2 text-sm pt-4">
                    <a href="#" class="text-blue-600 hover:underline block">Forgot Password?</a>
                    <p class="text-gray-600">Contact IT Helpdesk</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden min-h-screen">
        <!-- Header -->
        <header class="bg-gradient-to-r from-blue-700 to-blue-600 text-white shadow-lg">
            <div class="max-w-[1600px] mx-auto p-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center shadow-md">
                            <i data-lucide="gauge" class="w-7 h-7 text-blue-700"></i>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold">Tyre Analysis Dashboard</h1>
                            <p class="text-sm text-blue-100">Enterprise Quality Control System</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="text-right">
                            <p class="text-sm text-blue-100">Logged in as</p>
                            <p class="font-semibold" id="userRoleDisplay">RPSCoE</p>
                        </div>
                        <button onclick="logout()" class="px-4 py-2 bg-blue-800 rounded-lg hover:bg-blue-900 flex items-center gap-2 font-semibold transition-all">
                            <i data-lucide="log-out" class="w-4 h-4"></i>
                            LOGOUT
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="bg-white border-b-2 border-gray-200 shadow-sm">
            <div class="max-w-[1600px] mx-auto flex gap-2 p-3 overflow-x-auto">
                <button onclick="switchTab('rpscoe')" id="tab-rpscoe" class="px-6 py-2.5 rounded-lg flex items-center gap-2 bg-blue-600 text-white font-semibold transition-all whitespace-nowrap">
                    <i data-lucide="settings" class="w-4 h-4"></i>
                    RPSCoE Configuration
                </button>
                <button onclick="switchTab('btp')" id="tab-btp" class="px-6 py-2.5 rounded-lg flex items-center gap-2 bg-gray-100 text-gray-700 hover:bg-gray-200 font-semibold transition-all whitespace-nowrap">
                    <i data-lucide="clipboard-check" class="w-4 h-4"></i>
                    BTP Quality
                </button>
                <button onclick="switchTab('comparison')" id="tab-comparison" class="px-6 py-2.5 rounded-lg flex items-center gap-2 bg-gray-100 text-gray-700 hover:bg-gray-200 font-semibold transition-all whitespace-nowrap">
                    <span>ðŸ“Š</span>
                    Data Comparison
                </button>
                <button onclick="switchTab('analytics')" id="tab-analytics" class="px-6 py-2.5 rounded-lg flex items-center gap-2 bg-gray-100 text-gray-700 hover:bg-gray-200 font-semibold transition-all whitespace-nowrap">
                    <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
                    Analytics Dashboard
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <main class="max-w-[1600px] mx-auto p-6">
            <!-- RPSCoE Tab -->
            <div id="content-rpscoe" class="space-y-6">
                <!-- Control Bar -->
                <div class="bg-white p-4 rounded-xl border-2 border-gray-200 shadow-sm">
                    <div class="flex justify-end items-center gap-4">
                        <div class="flex items-center gap-3 flex-1">
                            <select id="rpscoeRecipeSelect" onchange="handleRPSCoERecipeChange()" class="p-3 border-2 border-gray-300 rounded-lg text-sm min-w-[250px] focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all font-semibold">
                                <option value="">Select Recipe</option>
                            </select>
                            <select id="rpscoeVersionSelect" disabled class="p-3 border-2 border-gray-300 rounded-lg text-sm min-w-[200px] focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all font-semibold">
                                <option value="">Select Version</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-3">
                            <button onclick="resetRPSCoE()" class="px-6 py-2.5 bg-white border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition-all flex items-center gap-2">
                                <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                                Reset
                            </button>
                            <button id="saveTargetSpecsBtn" onclick="saveTargetSpecs()" disabled class="px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-semibold transition-all shadow-md flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500">
                                <i data-lucide="save" class="w-4 h-4"></i>
                                Save Target Specs
                            </button>
                            <button onclick="openLogHistory('rpscoe')" class="px-6 py-2.5 bg-gray-700 text-white rounded-lg hover:bg-gray-800 font-semibold transition-all flex items-center gap-2">
                                <i data-lucide="history" class="w-4 h-4"></i>
                                Log History
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Main Work Area -->
                <div id="rpscoeWorkArea" class="grid grid-cols-2 gap-6" style="display: none;">
                    <!-- Parameters Panel -->
                    <div class="bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden flex flex-col" style="height: 550px;">
                        <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <i data-lucide="list-checks" class="w-5 h-5 text-blue-600"></i>
                                Parameters & Target Specifications
                            </h3>
                        </div>
                        <div class="overflow-y-auto flex-1">
                            <table class="w-full parameter-table">
                                <thead>
                                    <tr>
                                        <th class="text-left border-b-2 border-gray-300">Parameter Name</th>
                                        <th class="text-left border-b-2 border-gray-300">Target Spec</th>
                                        <th class="text-center border-b-2 border-gray-300" style="width: 80px;">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="rpscoeParametersBody">
                                    <!-- Parameters will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- DWG & Notifications Panel -->
                    <div class="flex flex-col gap-6">
                        <div class="bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden flex-1" style="height: 340px;">
                            <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                    <i data-lucide="file-image" class="w-5 h-5 text-blue-600"></i>
                                    DWG Design Preview
                                </h3>
                            </div>
                            <div class="p-8 flex items-center justify-center h-full bg-gray-50">
                                <div class="text-center">
                                    <i data-lucide="image" class="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                                    <p class="text-gray-500 font-medium">DWG Preview will appear here</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recipe Selection View -->
                <div id="rpscoeRecipeList" class="grid grid-cols-3 gap-6">
                    <div class="col-span-2 bg-white p-6 rounded-xl border-2 border-gray-200 shadow-sm">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Select Recipe to Configure</h3>
                        <div id="rpscoeRecipeListContainer" class="grid grid-cols-2 gap-4">
                            <!-- Recipe cards will be populated here -->
                        </div>
                    </div>
                    <div class="col-span-1 bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden h-fit">
                        <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <i data-lucide="bell" class="w-5 h-5 text-blue-600"></i>
                                Edit Log Notifications
                            </h3>
                        </div>
                        <div class="p-4 space-y-2 overflow-y-auto" style="max-height: 400px;">
                            <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                <i data-lucide="edit-3" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm text-gray-700">10:22 â€“ Tread Width updated</span>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                <i data-lucide="package" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm text-gray-700">14:45 â€“ Version changed to v1.3</span>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                <i data-lucide="refresh-cw" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm text-gray-700">11:10 â€“ Specs synced from DWG</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BTP Tab -->
            <div id="content-btp" class="hidden space-y-6">
                <!-- Control Bar -->
                <div class="bg-white p-4 rounded-xl border-2 border-gray-200 shadow-sm">
                    <div class="flex justify-between items-center gap-4">
                        <div class="flex items-center gap-3 flex-1">
                             <select id="btpRecipeSelect" onchange="handleBTPRecipeChange()" class="p-3 border-2 border-gray-300 rounded-lg text-sm min-w-[250px] focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all font-semibold">
                                <option value="">Select Recipe</option>
                            </select>
                            <select id="btpVersionSelect" disabled class="p-3 border-2 border-gray-300 rounded-lg text-sm min-w-[200px] focus:border-blue-600 focus:ring-2 focus:ring-blue-200 transition-all font-semibold">
                                <option value="">Select Version</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-3">
                             <button onclick="openScheduleUploadModal()" class="px-6 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 font-semibold flex items-center gap-2 shadow-md">
                                <i data-lucide="upload" class="w-4 h-4"></i>
                                Schedule Upload
                            </button>
                            <button onclick="resetBTP()" class="px-6 py-2.5 bg-white border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold flex items-center gap-2">
                                <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                                Reset
                            </button>
                            <button onclick="openLogHistory('btp')" class="px-6 py-2.5 bg-gray-700 text-white rounded-lg hover:bg-gray-800 font-semibold flex items-center gap-2">
                                <i data-lucide="history" class="w-4 h-4"></i>
                                Log History
                            </button>
                        </div>
                    </div>
                </div>

                <!-- BTP Work Area -->
                <div id="btpWorkArea" class="grid grid-cols-2 gap-6" style="display: none;">
                    <div class="bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden flex flex-col" style="height: 550px;">
                        <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <i data-lucide="ruler" class="w-5 h-5 text-blue-600"></i>
                                Quality Measurements
                            </h3>
                        </div>
                        <div class="overflow-y-auto flex-1">
                            <table class="w-full parameter-table">
                                <thead>
                                    <tr>
                                        <th class="text-left border-b-2 border-gray-300">Parameter</th>
                                        <th class="text-left border-b-2 border-gray-300">Target Spec</th>
                                        <th class="text-center border-b-2 border-gray-300">Actual 1</th>
                                        <th class="text-center border-b-2 border-gray-300">Actual 2</th>
                                        <th class="text-center border-b-2 border-gray-300">Actual 3</th>
                                    </tr>
                                </thead>
                                <tbody id="btpMeasurementsBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="flex flex-col gap-6">
                        <div class="bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden flex-1" style="height: 340px;">
                            <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                    <i data-lucide="clock" class="w-5 h-5 text-yellow-600"></i>
                                    Recipes Pending for Scanning
                                </h3>
                            </div>
                            <div class="p-4 space-y-2 overflow-y-auto" id="btpPendingScans" style="max-height: 280px;"></div>
                        </div>
                         <!-- Notification Panel -->
                         <div class="bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden h-fit">
                            <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                    <i data-lucide="bell" class="w-5 h-5 text-blue-600"></i>
                                    Edit Log Notifications
                                </h3>
                            </div>
                            <div class="p-4 space-y-2 overflow-y-auto" style="max-height: 400px;">
                                <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                    <i data-lucide="upload" class="w-4 h-4 text-blue-600"></i>
                                    <span class="text-sm text-gray-700">10:30 â€“ Actuals uploaded (Recipe A)</span>
                                </div>
                                <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                    <i data-lucide="calendar" class="w-4 h-4 text-blue-600"></i>
                                    <span class="text-sm text-gray-700">11:15 â€“ Schedule date updated</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- BTP Recipe List -->
                <div id="btpRecipeList" class="grid grid-cols-3 gap-6">
                    <div class="col-span-2 bg-white p-6 rounded-xl border-2 border-gray-200 shadow-sm">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Select Recipe for BTP Quality</h3>
                        <div id="btpRecipeListContainer" class="grid grid-cols-2 gap-4"></div>
                    </div>
                     <div class="col-span-1 bg-white rounded-xl border-2 border-gray-200 shadow-sm overflow-hidden h-fit">
                        <div class="bg-gradient-to-r from-gray-50 to-white p-4 border-b-2 border-gray-200">
                            <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <i data-lucide="bell" class="w-5 h-5 text-blue-600"></i>
                                Edit Log Notifications
                            </h3>
                        </div>
                        <div class="p-4 space-y-2 overflow-y-auto" style="max-height: 400px;">
                            <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                <i data-lucide="upload" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm text-gray-700">10:30 â€“ Actuals uploaded (Recipe A)</span>
                            </div>
                            <div class="flex items-center gap-3 p-3 bg-blue-50 border-l-4 border-blue-600 rounded-lg">
                                <i data-lucide="calendar" class="w-4 h-4 text-blue-600"></i>
                                <span class="text-sm text-gray-700">11:15 â€“ Schedule date updated</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DATA COMPARISON TAB -->
            <div id="content-comparison" class="hidden space-y-6">
                <!-- React Data Comparison will mount here -->
                <div id="data-comparison-root"></div>
            </div>

            <!-- ANALYTICS DASHBOARD TAB -->
            <div id="content-analytics" class="hidden space-y-6">
                <!-- Title Banner -->
                <div class="bg-yellow-200 border-2 border-black p-4 mb-6 text-center shadow-sm">
                    <h2 class="text-3xl font-extrabold text-black uppercase tracking-wider" id="analytics-page-title">CTA Report</h2>
                </div>

                <!-- Filters -->
                <div class="bg-white p-4 rounded-lg shadow-sm mb-6 flex flex-col xl:flex-row items-center justify-between gap-4 border border-gray-200">
                    <div class="flex items-center gap-2">
                        <i data-lucide="filter" class="w-5 h-5 text-gray-500"></i>
                        <span class="font-bold text-gray-700">Select Period:</span>
                    </div>
                    <div class="flex flex-wrap justify-center gap-2" id="filter-container">
                        <!-- Buttons generated by JS -->
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- ROW 1: Monthly Specific -->
                    <div class="chart-card lg:col-span-2" id="card1">
                        <div class="chart-header"><h3 class="chart-title" id="title1">CTA Report</h3></div>
                        <div class="chart-body"><canvas id="chart1"></canvas></div>
                    </div>
                    <div class="chart-card" id="card2">
                        <div class="chart-header"><h3 class="chart-title" id="title2">Rating</h3></div>
                        <div class="chart-body"><canvas id="chart2"></canvas></div>
                    </div>

                    <!-- ROW 2: Monthly Specific -->
                    <div class="chart-card" id="card3">
                        <div class="chart-header"><h3 class="chart-title" id="title3">Component wise off</h3></div>
                        <div class="chart-body"><canvas id="chart3"></canvas></div>
                    </div>
                    <div class="chart-card" id="card4">
                        <div class="chart-header"><h3 class="chart-title" id="title4">Tread Parameter off</h3></div>
                        <div class="chart-body"><canvas id="chart4"></canvas></div>
                    </div>
                    <div class="chart-card" id="card5">
                        <div class="chart-header"><h3 class="chart-title" id="title5">Sidewall Parameter Off</h3></div>
                        <div class="chart-body"><canvas id="chart5"></canvas></div>
                    </div>

                    <!-- ROW 3: Trends (Visible only on All Months) -->
                    <div class="chart-card lg:col-span-1 hidden" id="card6">
                        <div class="chart-header"><h3 class="chart-title" id="title6">Monthly CTA Compliance</h3></div>
                        <div class="chart-body"><canvas id="chart6"></canvas></div>
                    </div>
                    <div class="chart-card lg:col-span-1 hidden" id="card7">
                        <div class="chart-header"><h3 class="chart-title" id="title7">Monthly Rating Report</h3></div>
                        <div class="chart-body"><canvas id="chart7"></canvas></div>
                    </div>
                    <div class="chart-card lg:col-span-1 hidden" id="card8">
                        <div class="chart-header"><h3 class="chart-title" id="title8">CTA - (A+B)% Vs (C+D)%</h3></div>
                        <div class="chart-body"><canvas id="chart8"></canvas></div>
                    </div>

                    <!-- ROW 4: Aggregate (Visible only on All Months) -->
                    <div class="chart-card col-span-full hidden" id="card9">
                        <div class="chart-header"><h3 class="chart-title" id="title9">Sizewise CTA Complaince Report</h3></div>
                        <div class="chart-body"><canvas id="chart9"></canvas></div>
                    </div>

                    <!-- ROW 5: Aggregate (Visible only on All Months) -->
                    <div class="chart-card hidden" id="card10">
                        <div class="chart-header"><h3 class="chart-title" id="title10">Overall Off parameters</h3></div>
                        <div class="chart-body"><canvas id="chart10"></canvas></div>
                    </div>
                    <div class="chart-card hidden" id="card11">
                        <div class="chart-header"><h3 class="chart-title" id="title11">Overall Off Tread Parameters</h3></div>
                        <div class="chart-body"><canvas id="chart11"></canvas></div>
                    </div>
                    <div class="chart-card hidden" id="card12">
                        <div class="chart-header"><h3 class="chart-title" id="title12">Overall Off Sidewall Parameters</h3></div>
                        <div class="chart-body"><canvas id="chart12"></canvas></div>
                    </div>

                    <!-- ROW 6: Aggregate (Visible only on All Months) -->
                    <div class="chart-card col-span-full hidden" id="card13">
                        <div class="chart-header"><h3 class="chart-title" id="title13">Sizewise C-Rated Report</h3></div>
                        <div class="chart-body"><canvas id="chart13"></canvas></div>
                    </div>

                    <!-- ROW 7: Aggregate (Visible only on All Months) -->
                    <div class="chart-card col-span-full hidden" id="card14">
                        <div class="chart-header"><h3 class="chart-title" id="title14">Overall Off parameters (7.00R15 Steel King 12PR TT)</h3></div>
                        <div class="chart-body"><canvas id="chart14"></canvas></div>
                    </div>

                    <!-- ROW 8: Aggregate (Visible only on All Months) -->
                    <div class="chart-card col-span-full hidden" id="card15">
                        <div class="chart-header"><h3 class="chart-title" id="title15">7.00R15 Steel King 12PR TT Spec Vs Average</h3></div>
                        <div class="chart-body h-[400px]"><canvas id="chart15"></canvas></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white text-center p-4 mt-8">
            <p class="text-sm">Â© 2026 Tyre Analysis System | Enterprise Edition v2.0</p>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Log History Modal -->
    <div id="logHistoryModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden">
            <div class="bg-gradient-to-r from-blue-700 to-blue-600 text-white p-6 flex justify-between items-center">
                <div class="flex items-center gap-3"><i data-lucide="history" class="w-6 h-6"></i><div><h2 class="text-xl font-bold">Edit Log History</h2><p class="text-sm text-blue-100" id="logHistorySubtitle">Recipe Parameter Changes</p></div></div>
                <button onclick="closeLogHistoryModal()" class="text-white hover:bg-blue-800 rounded-full p-2"><i data-lucide="x" class="w-6 h-6"></i></button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 180px);">
                <table class="w-full border-collapse">
                    <thead class="sticky top-0 bg-gray-100 z-10"><tr class="bg-gray-200"><th class="border-2 border-gray-300 p-3 text-left">Recipe Name</th><th class="border-2 border-gray-300 p-3 text-left">Edited By (ID)</th><th class="border-2 border-gray-300 p-3 text-left">Edit Source</th><th class="border-2 border-gray-300 p-3 text-left">Time</th><th class="border-2 border-gray-300 p-3 text-left">Version</th></tr></thead>
                    <tbody id="logHistoryTableBody"></tbody>
                </table>
            </div>
            <div class="bg-gray-100 p-4 flex justify-end border-t-2 border-gray-200"><button onclick="closeLogHistoryModal()" class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-semibold">Close</button></div>
        </div>
    </div>
    
    <!-- Activation Modal -->
    <div id="activationModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg">
            <div class="bg-gradient-to-r from-blue-700 to-blue-600 text-white p-6 rounded-t-xl">
                <h2 class="text-xl font-bold">Activate Target Specifications</h2>
                <p class="text-sm text-blue-100 mt-2">Set the effective date from which these target specifications will be used by the BTP team.</p>
            </div>
            
            <div class="p-6">
                <div class="mb-6">
                    <label class="block text-sm font-semibold mb-2 text-gray-700">ðŸ“… Effective From Date</label>
                    <input type="date" id="effectiveDate" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-600 focus:ring-2 focus:ring-blue-200">
                    <p class="text-xs text-gray-500 mt-2">By default, today's date is selected. BTP actual entries will follow these specs from the selected date onward.</p>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-600 p-4 rounded-lg mb-6">
                    <p class="text-sm text-yellow-800 flex items-center gap-2">
                        <i data-lucide="alert-triangle" class="w-5 h-5"></i>
                        Are you sure you want to activate these target specifications? This action will impact all BTP actual measurements from the selected date.
                    </p>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-b-xl flex justify-between items-center border-t-2 border-gray-200">
                <p class="text-xs text-gray-600">You can update the effective date later from the configuration history if required.</p>
                <div class="flex gap-3">
                    <button onclick="cancelActivation()" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold">Cancel</button>
                    <button onclick="confirmActivation()" class="px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 font-semibold">Confirm & Activate</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Upload Modal -->
    <div id="scheduleUploadModal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
        <!-- Upload Form State -->
        <div id="scheduleUploadContent" class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden transition-all">
            <div class="bg-emerald-500 text-white p-5 flex justify-between items-start">
                <div>
                    <h2 class="text-lg font-bold">Schedule Upload</h2>
                    <p class="text-sm text-emerald-50 mt-1">Upload daily production schedule or actuals.</p>
                </div>
                <div class="bg-white/20 p-2 rounded-lg">
                    <i data-lucide="upload" class="w-5 h-5 text-white"></i>
                </div>
            </div>
            
            <div class="p-6">
                <label class="block text-sm font-semibold text-gray-700 mb-3">Select Schedule File</label>
                
                <div class="border-2 border-dashed border-gray-300 rounded-xl p-8 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-gray-50 hover:border-emerald-400 transition-all group" onclick="document.getElementById('btpExcelFile').click()">
                    <div class="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-4 group-hover:bg-white group-hover:shadow-sm transition-all">
                        <i data-lucide="file-spreadsheet" class="w-6 h-6 text-gray-500 group-hover:text-emerald-500"></i>
                    </div>
                    <p class="text-gray-600 font-medium">Drag and drop Excel/CSV file here</p>
                    <p class="text-sm text-gray-400 mt-1">or click to browse</p>
                    <input type="file" id="btpExcelFile" accept=".xlsx,.xls,.csv" class="hidden" onchange="handleFileSelect(this)">
                </div>
                
                <div id="fileNameDisplay" class="hidden mt-3 p-2 bg-emerald-50 rounded border border-emerald-100 text-sm text-emerald-700 font-medium flex items-center gap-2 animate-fade-in">
                    <i data-lucide="check-circle" class="w-4 h-4"></i>
                    <span id="selectedFileName"></span>
                </div>

                <div class="mt-6 bg-blue-50 border border-blue-100 rounded-lg p-4 flex gap-3">
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-blue-600 flex-shrink-0"></i>
                    <p class="text-xs text-blue-700 leading-relaxed">
                        Ensure the file follows the standard BTP Schedule template (v2.4) to avoid parsing errors.
                    </p>
                </div>
            </div>

            <div class="p-4 bg-gray-50 flex justify-between items-center gap-3">
                <button onclick="closeScheduleUploadModal()" class="px-6 py-2.5 bg-gray-100 text-gray-700 font-semibold rounded-lg hover:bg-gray-200 transition-colors flex-1">Cancel</button>
                <button onclick="confirmScheduleUpload()" class="px-6 py-2.5 bg-emerald-600 text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors flex items-center justify-center gap-2 flex-1 shadow-lg shadow-emerald-200">
                    <i data-lucide="upload" class="w-4 h-4"></i> Upload Schedule
                </button>
            </div>
        </div>

        <!-- Success State -->
        <div id="scheduleUploadSuccess" class="hidden bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden transition-all transform scale-100">
             <div class="bg-emerald-500 text-white p-5 flex justify-between items-start">
                <div>
                    <h2 class="text-lg font-bold">Schedule Upload</h2>
                    <p class="text-sm text-emerald-50 mt-1">Upload daily production schedule or actuals.</p>
                </div>
                <div class="bg-white/20 p-2 rounded-lg">
                    <i data-lucide="upload" class="w-5 h-5 text-white"></i>
                </div>
            </div>
            <div class="p-10 flex flex-col items-center text-center">
                <div class="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mb-6 animate-bounce">
                    <i data-lucide="check" class="w-10 h-10 text-emerald-600"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-2">Upload Successful!</h3>
                <p class="text-gray-500">The schedule has been processed.</p>
            </div>
        </div>
    </div>

    <script>
        // Data Structures
        const RECIPES_DATA = [
            { id: 'recipe-a', name: 'Recipe A - Standard Compound', description: 'Standard formulation', versions: ['v1.0', 'v1.1', 'v1.2', 'v1.3'] },
            { id: 'recipe-b', name: 'Recipe B - High Performance', description: 'Enhanced grip and handling', versions: ['v2.0', 'v2.1', 'v2.2'] },
            { id: 'recipe-c', name: 'Recipe C - All Weather', description: 'Optimized for all-season', versions: ['v3.0', 'v3.1', 'v3.2'] },
            { id: 'recipe-d', name: 'Recipe D - Heavy Duty', description: 'Reinforced compound', versions: ['v1.0', 'v1.1', 'v1.2', 'v1.3', 'v1.4', 'v1.5'] },
            { id: 'recipe-e', name: 'Recipe E - Eco Friendly', description: 'Low rolling resistance', versions: ['v2.0', 'v2.1'] },
            { id: 'recipe-f', name: 'Recipe F - Winter Special', description: 'Cold weather optimized', versions: ['v4.0', 'v4.1', 'v4.2'] }
        ];

        const PARAMETERS = [
            'Overall Tread Center Gauge', 'Overall Shoulder Gauge SS', 'Overall Shoulder Gauge OSS', 'Tread Center Rubber Gauge', 'Tread shoulder Rubber gauge SS',
            'Tread shoulder Rubber gauge OSS', 'Under Tread 1 at Center', 'Under Tread 2 at Shoulder SS', 'Under Tread 2 at Shoulder OSS', 'Inner Liner gauge at shoulders SS',
            'Inner Liner gauge at shoulders OSS', 'Belt 1 Width', 'Belt 2 Width', 'Belt 1 Centering SS', 'Belt 1 Centering OSS'
        ]; // Shortened for brevity, use full list in production

        const BTP_RECIPE_STATUS = {
            'recipe-a': 'completed', 'recipe-b': 'pending', 'recipe-c': 'completed', 'recipe-d': 'pending', 'recipe-e': 'pending', 'recipe-f': 'completed'
        };

        let appState = {
            currentTab: 'rpscoe',
            rpscoe: { selectedRecipe: null, selectedVersion: null, parameterData: [] },
            btp: { selectedRecipe: null, selectedVersion: null }
        };

        // --- Analytics Dashboard Logic ---
        const COLORS = {
            primary: '#3b82f6', secondary: '#f97316', success: '#22c55e', danger: '#ef4444',
            gray: '#9ca3af', darkBlue: '#1e3a8a', yellow: '#eab308', purple: '#a78bfa',
            teal: '#34d399', sky: '#60a5fa', lightOrange: '#fbbf24', lime: '#a3e635',
            cyan: '#22d3ee', pink: '#f472b6'
        };
        const MONTHS = ['Apr-25', 'May-25', 'Jun-25', 'Jul-25', 'Aug-25', 'Sep-25', 'Oct-25', 'Nov-25', 'Dec-25', 'Jan-26', 'Feb-26', 'Mar-26'];
        let analyticsInitialized = false;
        let selectedPeriod = 'All Months';
        const chartInstances = {};

        // Initialization
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            populateDropdowns();
            renderRecipeCards();
            setDefaultEffectiveDate();
        });

        function populateDropdowns() {
            const rpscoeSelect = document.getElementById('rpscoeRecipeSelect');
            const btpSelect = document.getElementById('btpRecipeSelect');
            const options = RECIPES_DATA.map(recipe => `<option value="${recipe.id}">${recipe.name}</option>`).join('');
            if (rpscoeSelect) rpscoeSelect.innerHTML = '<option value="">Select Recipe</option>' + options;
            if (btpSelect) btpSelect.innerHTML = '<option value="">Select Recipe</option>' + options;
        }

        function setDefaultEffectiveDate() {
            const today = new Date().toISOString().split('T')[0];
            const el = document.getElementById('effectiveDate');
            if(el) el.value = today;
        }

        // Logic
        function login() {
            const u = document.getElementById('loginUsername').value;
            const p = document.getElementById('loginPassword').value;
            const r = document.getElementById('loginRole').value;
            if (!u || !p || !r) { alert('Please fill in all fields'); return; }
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            const roleText = r === 'rpscoe' ? 'RPSCoE' : r === 'btp-quality' ? 'BTP Quality' : 'BTP Technical';
            document.getElementById('userRoleDisplay').textContent = roleText;
            if (r === 'btp-quality') { document.getElementById('tab-rpscoe').style.display = 'none'; switchTab('btp'); }
            else { document.getElementById('tab-rpscoe').style.display = 'flex'; switchTab('rpscoe'); }
            lucide.createIcons();
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                document.getElementById('loginRole').value = '';
                appState = { currentTab: 'rpscoe', rpscoe: { selectedRecipe: null, selectedVersion: null, parameterData: [] }, btp: { selectedRecipe: null, selectedVersion: null } };
            }
        }

        function switchTab(tabId) {
            appState.currentTab = tabId;
            document.querySelectorAll('[id^="tab-"]').forEach(btn => btn.className = 'px-6 py-2.5 rounded-lg flex items-center gap-2 bg-gray-100 text-gray-700 hover:bg-gray-200 font-semibold transition-all whitespace-nowrap');
            document.getElementById('tab-' + tabId).className = 'px-6 py-2.5 rounded-lg flex items-center gap-2 bg-blue-600 text-white font-semibold transition-all whitespace-nowrap';
            document.querySelectorAll('[id^="content-"]').forEach(content => content.classList.add('hidden'));
            document.getElementById('content-' + tabId).classList.remove('hidden');
            
            if (tabId === 'comparison') mountDataComparison();
            if (tabId === 'analytics') {
                if(!analyticsInitialized) initAnalyticsDashboard();
                else updateDashboard(selectedPeriod); // refresh charts if needed
            }
            lucide.createIcons();
        }

        function renderRecipeCards() {
            const rpscoeContainer = document.getElementById('rpscoeRecipeListContainer');
            const btpContainer = document.getElementById('btpRecipeListContainer');
            
            if (rpscoeContainer) {
                rpscoeContainer.innerHTML = RECIPES_DATA.map(recipe => `
                    <div class="border-2 border-gray-200 rounded-xl p-6 hover:border-blue-600 hover:shadow-lg transition-all cursor-pointer" onclick="selectRecipeCard('${recipe.id}', 'rpscoe')">
                        <h4 class="font-bold text-lg text-gray-800 mb-2">${recipe.name.split(' - ')[0]}</h4>
                        <p class="text-sm text-gray-600 mb-3">${recipe.description}</p>
                        <div class="flex items-center justify-between"><span class="text-xs text-blue-600 font-semibold">44 Parameters</span><i data-lucide="arrow-right" class="w-4 h-4 text-blue-600"></i></div>
                    </div>`).join('');
            }
            if (btpContainer) {
                btpContainer.innerHTML = RECIPES_DATA.map(recipe => {
                    const status = BTP_RECIPE_STATUS[recipe.id] || 'pending';
                    const statusText = status === 'completed' ? 'Completed' : 'Pending';
                    return `
                        <div class="border-2 border-gray-200 rounded-xl p-6 hover:border-blue-600 hover:shadow-lg transition-all cursor-pointer relative status-${status}" onclick="selectRecipeCard('${recipe.id}', 'btp')">
                            <span class="recipe-status-badge recipe-status-${status}">${statusText}</span>
                            <h4 class="font-bold text-lg text-gray-800 mb-2">${recipe.name.split(' - ')[0]}</h4>
                            <p class="text-sm text-gray-600 mb-3">${recipe.description}</p>
                            <div class="flex items-center justify-between"><span class="text-xs text-blue-600 font-semibold">44 Parameters</span><i data-lucide="arrow-right" class="w-4 h-4 text-blue-600"></i></div>
                        </div>`;
                }).join('');
            }
            lucide.createIcons();
        }

        function selectRecipeCard(id, tab) {
            const recipe = RECIPES_DATA.find(r => r.id === id);
            if (!recipe) return;
            if (tab === 'rpscoe') {
                appState.rpscoe.selectedRecipe = recipe;
                appState.rpscoe.selectedVersion = recipe.versions[recipe.versions.length - 1];
                appState.rpscoe.parameterData = generateParameterData();
                document.getElementById('rpscoeRecipeSelect').value = id;
                const vSel = document.getElementById('rpscoeVersionSelect');
                vSel.disabled = false;
                vSel.innerHTML = '<option value="">Select Version</option>' + recipe.versions.map((v, i) => `<option value="${v}" ${i===recipe.versions.length-1?'selected':''}>${v}${i===recipe.versions.length-1?' (Latest)':''}</option>`).join('');
                document.getElementById('rpscoeWorkArea').style.display = 'grid';
                document.getElementById('rpscoeRecipeList').style.display = 'none';
                document.getElementById('saveTargetSpecsBtn').disabled = false;
                renderRPSCoEParameters();
            } else if (tab === 'btp') {
                appState.btp.selectedRecipe = recipe;
                appState.btp.selectedVersion = recipe.versions[recipe.versions.length-1];
                document.getElementById('btpRecipeSelect').value = id;
                const vSel = document.getElementById('btpVersionSelect');
                vSel.disabled = false;
                vSel.innerHTML = '<option value="">Select Version</option>' + recipe.versions.map((v, i) => `<option value="${v}" ${i===recipe.versions.length-1?'selected':''}>${v}${i===recipe.versions.length-1?' (Latest)':''}</option>`).join('');
                document.getElementById('btpWorkArea').style.display = 'grid';
                document.getElementById('btpRecipeList').style.display = 'none';
                renderBTPMeasurements();
                renderBTPPendingScans();
            }
            lucide.createIcons();
        }
        
        function handleRPSCoERecipeChange() {
            const id = document.getElementById('rpscoeRecipeSelect').value;
            if(id) selectRecipeCard(id, 'rpscoe');
            else resetRPSCoE();
        }

        function handleBTPRecipeChange() {
             const id = document.getElementById('btpRecipeSelect').value;
             if(id) selectRecipeCard(id, 'btp');
             else resetBTP();
        }

        function generateParameterData() {
            return PARAMETERS.map((p, i) => ({ name: p, targetSpec: (i % 7 === 0) ? null : `${(Math.random() * 100 + 50).toFixed(2)}`, id: `param_${i}` }));
        }

        function renderRPSCoEParameters() {
            const tbody = document.getElementById('rpscoeParametersBody');
            tbody.innerHTML = appState.rpscoe.parameterData.map(p => {
                const isNull = !p.targetSpec;
                return `<tr class="${isNull?'row-null':''}">
                    <td class="border-b border-gray-200">${p.name}</td>
                    <td class="border-b border-gray-200 ${isNull?'cell-null':''}" id="spec-${p.id}">${isNull?'Null':p.targetSpec}</td>
                    <td class="border-b border-gray-200 text-center"><span class="edit-icon inline-flex" onclick="enableInlineEdit('${p.id}')"><i data-lucide="pencil" class="w-4 h-4"></i></span></td>
                </tr>`;
            }).join('');
            lucide.createIcons();
        }

        function enableInlineEdit(id) {
            const param = appState.rpscoe.parameterData.find(p => p.id === id);
            if(!param) return;
            document.getElementById(`spec-${id}`).innerHTML = `<input type="text" class="inline-edit-input" id="edit-input-${id}" value="${param.targetSpec||''}" onkeypress="if(event.key==='Enter') saveInlineEdit('${id}')" onblur="saveInlineEdit('${id}')">`;
            document.getElementById(`edit-input-${id}`).focus();
        }

        function saveInlineEdit(id) {
            const input = document.getElementById(`edit-input-${id}`);
            if(!input) return;
            const param = appState.rpscoe.parameterData.find(p => p.id === id);
            if(param) param.targetSpec = input.value.trim() || null;
            renderRPSCoEParameters();
        }

        function resetRPSCoE() {
            appState.rpscoe = { selectedRecipe: null, selectedVersion: null, parameterData: [] };
            document.getElementById('rpscoeRecipeSelect').value = '';
            document.getElementById('rpscoeVersionSelect').innerHTML = '<option value="">Select Version</option>';
            document.getElementById('rpscoeVersionSelect').disabled = true;
            document.getElementById('rpscoeWorkArea').style.display = 'none';
            document.getElementById('rpscoeRecipeList').style.display = 'grid';
            document.getElementById('saveTargetSpecsBtn').disabled = true;
        }

        function saveTargetSpecs() { document.getElementById('activationModal').classList.remove('hidden'); }
        function cancelActivation() { document.getElementById('activationModal').classList.add('hidden'); }
        
        function confirmActivation() {
            const dateInput = document.getElementById('effectiveDate');
            if(!dateInput.value) {
                alert('Please select an Effective From Date.');
                return;
            }

            // Check for null values in current parameters
            const nullCount = appState.rpscoe.parameterData.reduce((acc, p) => {
                return acc + (p.targetSpec === null || p.targetSpec === '' ? 1 : 0);
            }, 0);

            if (nullCount > 0) {
                const proceed = confirm(`Warning: ${nullCount} parameter(s) have NULL values.\n\nDo you want to activate anyway?`);
                if (!proceed) return;
            }

            document.getElementById('activationModal').classList.add('hidden');
            
            const recipeName = appState.rpscoe.selectedRecipe ? appState.rpscoe.selectedRecipe.name : 'Unknown';
            const effectiveDate = dateInput.value;

            alert(`Target specifications activated successfully!\n\nRecipe: ${recipeName}\nEffective From: ${effectiveDate}`);
        }

        function renderBTPMeasurements() {
            const tbody = document.getElementById('btpMeasurementsBody');
            const rid = appState.btp.selectedRecipe?.id;
            const isPending = BTP_RECIPE_STATUS[rid] === 'pending';
            tbody.innerHTML = PARAMETERS.map((p, i) => {
                const base = 5 + (i % 10);
                const cls = isPending ? 'text-center font-bold text-yellow-600 italic bg-yellow-100' : 'text-center font-semibold';
                return `<tr class="${isPending?'bg-yellow-50':'hover:bg-gray-50'}">
                    <td class="border-b border-gray-200">${p}</td>
                    <td class="border-b border-gray-200">${base.toFixed(2)} mm</td>
                    <td class="border-b border-gray-200 ${cls}">${isPending?'':(base+Math.random()).toFixed(2)}</td>
                    <td class="border-b border-gray-200 ${cls}">${isPending?'':(base+Math.random()).toFixed(2)}</td>
                    <td class="border-b border-gray-200 ${cls}">${isPending?'':(base+Math.random()).toFixed(2)}</td>
                </tr>`;
            }).join('');
        }

        function renderBTPPendingScans() {
             const container = document.getElementById('btpPendingScans');
             const pending = RECIPES_DATA.filter(r => BTP_RECIPE_STATUS[r.id] === 'pending');
             container.innerHTML = pending.length ? pending.map(r => `
                <div class="flex items-center justify-between p-3 bg-yellow-50 border-l-4 border-yellow-600 rounded-lg">
                    <span class="text-sm font-medium text-gray-800">${r.name.split(' - ')[0]}</span>
                    <span class="px-3 py-1 bg-yellow-600 text-white text-xs font-bold rounded-full">Pending</span>
                </div>`).join('') : '<div class="text-center py-8 text-gray-500">âœ“ All recipes completed</div>';
        }

        function resetBTP() {
            appState.btp = { selectedRecipe: null, selectedVersion: null };
            document.getElementById('btpRecipeSelect').value = '';
            document.getElementById('btpVersionSelect').disabled = true;
            document.getElementById('btpWorkArea').style.display = 'none';
            document.getElementById('btpRecipeList').style.display = 'grid';
            renderBTPPendingScans();
        }


function openLogHistory(tab) {
    const modal = document.getElementById('logHistoryModal');
    const tbody = document.getElementById('logHistoryTableBody');

    document.getElementById('logHistorySubtitle').textContent =
        tab === 'rpscoe'
            ? 'RPSCoE Configuration Changes'
            : 'BTP Quality Actual Measurements';

    if (tab === 'rpscoe') {
tbody.innerHTML = `
            <tr>
                <td class="border-2 p-3">Recipe A - Standard Compound</td>
                <td class="border-2 p-3">USER_12345</td>
                <td class="border-2 p-3">
                    <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">
                        Web Portal
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-12 10:22:15</td>
                <td class="border-2 p-3 font-semibold">v1.3</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe B - High Performance</td>
                <td class="border-2 p-3">USER_67890</td>
                <td class="border-2 p-3">
                    <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">
                        DWG
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-12 09:45:30</td>
                <td class="border-2 p-3 font-semibold">v2.1</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe C - All Weather</td>
                <td class="border-2 p-3">USER_54321</td>
                <td class="border-2 p-3">
                    <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">
                        Web Portal
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-11 16:30:00</td>
                <td class="border-2 p-3 font-semibold">v3.2</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe D - Heavy Duty</td>
                <td class="border-2 p-3">USER_11111</td>
                <td class="border-2 p-3">
                    <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">
                        DWG
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-11 14:15:45</td>
                <td class="border-2 p-3 font-semibold">v1.5</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe E - Eco Friendly</td>
                <td class="border-2 p-3">USER_22222</td>
                <td class="border-2 p-3">
                    <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm">
                        Web Portal
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-10 11:20:10</td>
                <td class="border-2 p-3 font-semibold">v2.1</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe F - Winter Special</td>
                <td class="border-2 p-3">USER_33333</td>
                <td class="border-2 p-3">
                    <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm">
                        DWG
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-10 08:50:25</td>
                <td class="border-2 p-3 font-semibold">v4.1</td>
            </tr>
        `;
    } else {
        tbody.innerHTML = `
            <tr>
                <td class="border-2 p-3">Recipe A - Standard Compound</td>
                <td class="border-2 p-3">USER_45678</td>
                <td class="border-2 p-3">
                    <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-sm">
                        Excel Sheet
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-13 14:30:22</td>
                <td class="border-2 p-3">v1.3</td>
            </tr>

            <tr>
                <td class="border-2 p-3">Recipe B - High Performance</td>
                <td class="border-2 p-3">USER_56789</td>
                <td class="border-2 p-3">
                    <span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-sm">
                        Excel Sheet
                    </span>
                </td>
                <td class="border-2 p-3">2026-01-12 10:30:55</td>
                <td class="border-2 p-3">v2.2</td>
            </tr>
        `;
    }

    modal.classList.remove('hidden');
    lucide.createIcons();
}


        function closeLogHistoryModal() { document.getElementById('logHistoryModal').classList.add('hidden'); }
        function openScheduleUploadModal() { 
            document.getElementById('scheduleUploadModal').classList.remove('hidden');
            document.getElementById('scheduleUploadContent').classList.remove('hidden');
            document.getElementById('scheduleUploadSuccess').classList.add('hidden');
            document.getElementById('btpExcelFile').value = '';
            document.getElementById('selectedFileName').textContent = '';
            document.getElementById('fileNameDisplay').classList.add('hidden');
            lucide.createIcons();
        }
        function closeScheduleUploadModal() { document.getElementById('scheduleUploadModal').classList.add('hidden'); }
        function handleFileSelect(input) {
            if (input.files && input.files.length > 0) {
                document.getElementById('selectedFileName').textContent = input.files[0].name;
                document.getElementById('fileNameDisplay').classList.remove('hidden');
            }
        }
        function confirmScheduleUpload() {
            document.getElementById('scheduleUploadContent').classList.add('hidden');
            document.getElementById('scheduleUploadSuccess').classList.remove('hidden');
            lucide.createIcons(); 
            if(appState.btp.selectedRecipe) {
                BTP_RECIPE_STATUS[appState.btp.selectedRecipe.id] = 'completed';
                renderBTPMeasurements();
                renderBTPPendingScans();
                renderRecipeCards();
            }
            setTimeout(() => { closeScheduleUploadModal(); }, 2000);
        }

        // --- Analytics Dashboard Initialization ---
        function initAnalyticsDashboard() {
            Chart.defaults.font.family = "'Inter', sans-serif";
            Chart.defaults.font.size = 11;
            Chart.defaults.maintainAspectRatio = false;
            Chart.defaults.plugins.legend.position = 'top';
            Chart.defaults.plugins.tooltip.mode = 'index';
            Chart.defaults.plugins.tooltip.intersect = false;

            const filterContainer = document.getElementById('filter-container');
            const periods = ['All Months', ...MONTHS];

            periods.forEach(period => {
                const btn = document.createElement('button');
                btn.textContent = period;
                btn.className = `filter-btn ${period === selectedPeriod ? 'filter-btn-active' : 'filter-btn-inactive'}`;
                btn.onclick = () => updateDashboard(period);
                filterContainer.appendChild(btn);
            });

            // Chart 1
            chartInstances['c1'] = new Chart(document.getElementById('chart1'), {
                type: 'bar',
                data: { labels: ['A Grade', 'B Grade', 'C Grade', 'D Grade', 'Total Tires'], datasets: [{ label: 'Value', data: [0, 31, 9, 0, 40], backgroundColor: [COLORS.danger, COLORS.secondary, COLORS.yellow, COLORS.danger, COLORS.success] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 2
            chartInstances['c2'] = new Chart(document.getElementById('chart2'), {
                type: 'pie',
                data: { labels: ['A+B', 'C+D'], datasets: [{ data: [77.5, 22.5], backgroundColor: [COLORS.success, COLORS.danger] }] }
            });
            // Chart 3
            chartInstances['c3'] = new Chart(document.getElementById('chart3'), {
                type: 'bar',
                data: { labels: ['Tread', 'Sidewall', 'Ply Ht'], datasets: [{ label: 'Value', data: [19, 3, 1], backgroundColor: [COLORS.sky, COLORS.secondary, COLORS.gray] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 4
            chartInstances['c4'] = new Chart(document.getElementById('chart4'), {
                type: 'bar',
                data: { labels: ['UT_CL', 'UT_SH', 'CL(Rubber)', 'SH(Rubber)', 'CL(Total)'], datasets: [{ label: 'Count', data: [7, 5, 1, 1, 0], backgroundColor: COLORS.primary }] }
            });
            // Chart 5
            chartInstances['c5'] = new Chart(document.getElementById('chart5'), {
                type: 'bar',
                data: { labels: ['Rim Strip', 'SW(Rubber)', 'Pad', 'Ending'], datasets: [{ label: 'Count', data: [2, 1, 0, 0], backgroundColor: COLORS.primary }] }
            });
            // Chart 6
            const monthsSlice = MONTHS.slice(0, 9);
            chartInstances['c6'] = new Chart(document.getElementById('chart6'), {
                type: 'bar',
                data: { labels: monthsSlice, datasets: [ { label: 'Done', data: [39, 22, 39, 23, 36, 41, 35, 41, 40], backgroundColor: COLORS.primary }, { label: 'Target', data: [40, 40, 40, 40, 40, 40, 40, 40, 40], backgroundColor: COLORS.secondary } ] }
            });
            // Chart 7
            chartInstances['c7'] = new Chart(document.getElementById('chart7'), {
                type: 'bar',
                data: { labels: monthsSlice, datasets: [ { label: 'A', data: [5, 2, 4, 1, 5, 4, 2, 6, 0], backgroundColor: COLORS.primary }, { label: 'B', data: [27, 16, 29, 20, 26, 29, 25, 33, 31], backgroundColor: COLORS.secondary }, { label: 'C', data: [4, 1, 3, 2, 3, 3, 1, 2, 9], backgroundColor: COLORS.success }, { label: 'D', data: [0, 0, 0, 0, 0, 0, 0, 0, 0], backgroundColor: COLORS.danger } ] }
            });
            // Chart 8
            chartInstances['c8'] = new Chart(document.getElementById('chart8'), {
                type: 'bar',
                data: { labels: monthsSlice, datasets: [ { label: 'Good', data: [80, 72.8, 76.9, 87.0, 72.2, 72.5, 71.4, 80.5, 77.5], backgroundColor: COLORS.primary }, { label: 'Bad', data: [20, 28.2, 23.1, 13.0, 27.8, 27.5, 28.6, 19.5, 22.5], backgroundColor: COLORS.secondary } ] },
                options: { scales: { x: { stacked: true }, y: { stacked: true } } }
            });
            // Chart 9
            chartInstances['c9'] = new Chart(document.getElementById('chart9'), {
                type: 'bar',
                data: { labels: ['12.00R20', '10.00R20', '8.25R16', '7.50R16', '11R22.5', '295/80R', '315/80R', '12R22.5', '145/70R', '155/60R', '165/70R', '195/80R', '205/65R', '215/75R', '225/70R', '235/85R', '245/70R', '255/65R', '265/60R', '275/55R', '285/50R', '295/35R', '305/40R', '325/30R', '7.00R15'], datasets: [{ label: 'Count', data: [9, 12, 12, 11, 2, 10, 10, 5, 12, 8, 9, 14, 5, 3, 2, 11, 5, 2, 4, 7, 3, 5, 9, 6, 29], backgroundColor: COLORS.secondary }] },
                options: { plugins: { legend: { display: false } }, scales: { x: { ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 } } } }
            });
            // Chart 10
            chartInstances['c10'] = new Chart(document.getElementById('chart10'), {
                type: 'bar',
                data: { labels: ['Tread', 'Sidewall', 'Belt', 'Filler HT', 'Ply', 'Toe-Toe'], datasets: [{ label: 'Value', data: [135, 48, 7, 4, 3, 1], backgroundColor: [COLORS.sky, COLORS.secondary, COLORS.gray, COLORS.lightOrange, COLORS.purple, COLORS.teal] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 11
            chartInstances['c11'] = new Chart(document.getElementById('chart11'), {
                type: 'bar',
                data: { labels: ['UT_SH', 'UT_CL', 'SH(Rubber)', 'CL(Rubber)', 'SH(Total)', 'CL(Total)'], datasets: [{ label: 'Value', data: [44, 33, 27, 19, 11, 1], backgroundColor: [COLORS.sky, COLORS.secondary, COLORS.lightOrange, COLORS.lime, COLORS.cyan, COLORS.pink] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 12
            chartInstances['c12'] = new Chart(document.getElementById('chart12'), {
                type: 'bar',
                data: { labels: ['RS_HT', 'Pad Gauge', 'SW(Ending)', 'SW(Rubber)'], datasets: [{ label: 'Value', data: [20, 11, 9, 8], backgroundColor: [COLORS.sky, COLORS.secondary, COLORS.gray, COLORS.lightOrange] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 13
            chartInstances['c13'] = new Chart(document.getElementById('chart13'), {
                type: 'bar',
                data: { labels: ['7.00R15', '215/75R15', '205/65R15', '155/80R13', '165/80R14', '185/65R15', '195/80R15', '175/70R14'], datasets: [{ label: 'Value', data: [28, 12, 7, 5, 4, 3, 3, 3], backgroundColor: COLORS.sky }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 14
            chartInstances['c14'] = new Chart(document.getElementById('chart14'), {
                type: 'bar',
                data: { labels: ['CL(Rubber)', 'SH(Rubber)', 'UT_CL', 'UT_SH', 'SW Ending', 'Rim Strip', 'SH(Total)'], datasets: [{ label: 'Value', data: [11, 5, 4, 4, 2, 2, 2], backgroundColor: [COLORS.sky, COLORS.secondary, COLORS.gray, COLORS.lightOrange, COLORS.primary, COLORS.success, COLORS.darkBlue] }] },
                options: { plugins: { legend: { display: false } } }
            });
            // Chart 15
            const specAvgLabels = ['Overall Shoulder Gauge', 'Overall Shoulder Gauge SS', 'Rim Strip height', 'Rim strip height OSS', 'SW ending from heel', 'SW ending from heel OSS', 'Tread Center Rubber', 'Tread Center Rubber Gauge', 'Tread Center Rubber Gauge 2', 'Tread Center Rubber Gauge 3', 'Tread Center Rubber Gauge 4', 'Tread Center Rubber Gauge 5', 'Tread Center Rubber Gauge 6', 'Tread Center Rubber Gauge 7', 'Tread Center Rubber Gauge 8', 'Tread Shoulder Rubber', 'Tread Shoulder Rubber 2', 'Tread 1 at Center', 'Tread 2 at Center', 'Under Tread 1 at Center', 'Under Tread 2 at Shoulder', 'Under Tread 2 at Shoulder OSS'];
            chartInstances['c15'] = new Chart(document.getElementById('chart15'), {
                type: 'bar',
                data: { labels: specAvgLabels, datasets: [ { type: 'line', label: 'Spec', data: [10, 12, 30, 89, 81, 20, 21, 14, 14, 15, 16, 17, 18, 19, 20, 21, 22, 4, 3.9, 3.5, 3.7, 4.8], borderColor: COLORS.primary, backgroundColor: COLORS.primary, borderWidth: 2, pointRadius: 3, tension: 0.1 }, { type: 'bar', label: 'Average', data: [12, 14, 28, 83, 76, 14, 16, 14, 13, 15, 15, 17, 18, 18, 19, 19, 20, 3.5, 3.9, 3.5, 3.7, 4.6], backgroundColor: COLORS.secondary } ] },
                options: { scales: { x: { ticks: { autoSkip: false, maxRotation: 45, minRotation: 45, font: { size: 10 } } } } }
            });

            analyticsInitialized = true;
            updateDashboard(selectedPeriod);
        }

        function updateDashboard(period) {
            selectedPeriod = period;
            const isAll = period === 'All Months';
            const factor = isAll ? 1 : 0.5 + (Math.sin(MONTHS.indexOf(period) + 1) * 10000 - Math.floor(Math.sin(MONTHS.indexOf(period) + 1) * 10000)) * 1.0;

            const buttons = document.querySelectorAll('.filter-btn');
            buttons.forEach(btn => btn.className = `filter-btn ${btn.textContent === period ? 'filter-btn-active' : 'filter-btn-inactive'}`);

            const monthlyCards = ['card1', 'card2', 'card3', 'card4', 'card5'];
            const trendCards = ['card6', 'card7', 'card8', 'card9', 'card10', 'card11', 'card12', 'card13', 'card14', 'card15'];

            if (isAll) {
                monthlyCards.forEach(id => document.getElementById(id).classList.add('hidden'));
                trendCards.forEach(id => document.getElementById(id).classList.remove('hidden'));
                document.getElementById('analytics-page-title').textContent = 'Overall Performance Report - FY26';
            } else {
                monthlyCards.forEach(id => document.getElementById(id).classList.remove('hidden'));
                trendCards.forEach(id => document.getElementById(id).classList.add('hidden'));
                document.getElementById('analytics-page-title').textContent = `CTA Report - ${period}`;
                
                const suffix = period;
                document.getElementById('title1').textContent = `CTA Report - ${suffix}`;
                document.getElementById('title2').textContent = `Rating - ${suffix}`;
                document.getElementById('title3').textContent = `Component wise off - ${suffix}`;
                document.getElementById('title4').textContent = `Tread Parameter off - ${suffix}`;
                document.getElementById('title5').textContent = `Sidewall Parameter Off - ${suffix}`;

                // Update data for visible charts
                chartInstances['c1'].data.datasets[0].data = [Math.floor(2 * factor), Math.floor(31 * factor), Math.floor(9 * factor), Math.floor(1 * factor), Math.floor(40 * factor)];
                chartInstances['c1'].update();
                const c2Val1 = 77.5 + (factor * 5 - 5);
                chartInstances['c2'].data.datasets[0].data = [c2Val1, 100 - c2Val1];
                chartInstances['c2'].update();
                chartInstances['c3'].data.datasets[0].data = [Math.floor(19 * factor), Math.floor(3 * factor), Math.floor(1 * factor)];
                chartInstances['c3'].update();
                chartInstances['c4'].data.datasets[0].data = [Math.floor(7 * factor), Math.floor(5 * factor), 1, 1, 0];
                chartInstances['c4'].update();
                chartInstances['c5'].data.datasets[0].data = [Math.floor(2 * factor), 1, 0, 0];
                chartInstances['c5'].update();
            }
        }
    </script>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const IconBase = ({ children, className, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
        );
        const Gauge = (props) => <IconBase {...props}><path d="m12 14 4-4" /><path d="M3.34 19a10 10 0 1 1 17.32 0" /></IconBase>;
        const LogOut = (props) => <IconBase {...props}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" /><polyline points="16 17 21 12 16 7" /><line x1="21" x2="9" y1="12" y2="12" /></IconBase>;
        const CalendarRange = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" /><path d="M16 2v4" /><path d="M8 2v4" /><path d="M3 10h18" /><path d="M17 14h-6" /><path d="M13 18H7" /></IconBase>;
        const Scissors = (props) => <IconBase {...props}><circle cx="6" cy="6" r="3" /><circle cx="6" cy="18" r="3" /><line x1="20" x2="8.12" y1="4" y2="15.88" /><line x1="14.47" x2="20" y1="14.48" y2="20" /><line x1="8.12" x2="12" y1="8.12" y2="12" /></IconBase>;
        const AlertTriangle = (props) => <IconBase {...props}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><path d="M12 9v4" /><path d="M12 17h.01" /></IconBase>;
        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></IconBase>;
        const Filter = (props) => <IconBase {...props}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" /></IconBase>;
        const Download = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></IconBase>;
        const TableIcon = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="3" rx="2" ry="2" /><line x1="3" x2="21" y1="9" y2="9" /><line x1="3" x2="21" y1="15" y2="15" /><line x1="12" x2="12" y1="3" y2="21" /></IconBase>;
        const CalendarIcon = (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2" /><line x1="16" x2="16" y1="2" y2="6" /><line x1="8" x2="8" y1="2" y2="6" /><line x1="3" x2="21" y1="10" y2="10" /></IconBase>;
        const Printer = (props) => <IconBase {...props}><polyline points="6 9 6 2 18 2 18 9" /><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2" /><rect width="12" height="8" x="6" y="14" /></IconBase>;

        // React Components
        // --- CONSTANTS ---
        const monthlyCountData = [
            { id: 1, size: "120/80R12 ULT XPC 86F TL", module: "2 Stage", apr: 0, may: 0, jun: 2, jul: 1, aug: 1, sep: 0, oct: 2, nov: 2, dec: 1, jan: null, feb: null, mar: null, total: 9 },
            { id: 2, size: "120/80R12 ULT XPC1 74F TL", module: "2 Stage", apr: 2, may: 1, jun: 2, jul: 1, aug: 1, sep: 1, oct: 1, nov: 2, dec: 1, jan: null, feb: null, mar: null, total: 12 },
            { id: 3, size: "130/80R12 ULT XPC 90F TL", module: "2 Stage", apr: 2, may: 1, jun: 0, jul: 2, aug: 0, sep: 1, oct: 2, nov: 2, dec: 2, jan: null, feb: null, mar: null, total: 12 },
            { id: 4, size: "135/70R12 ULTIMA LXT 65S TL", module: "2 Stage", apr: 0, may: 0, jun: 0, jul: 0, aug: 0, sep: 0, oct: 0, nov: 2, dec: 0, jan: null, feb: null, mar: null, total: 2 },
            { id: 5, size: "135/70R15 STAR XT", module: "2 Stage", apr: 2, may: 0, jun: 0, jul: 0, aug: 2, sep: 2, oct: 2, nov: 1, dec: 2, jan: null, feb: null, mar: null, total: 11 },
            { id: 6, size: "145/80R12 Taximax TL", module: "2 Stage", apr: 0, may: 1, jun: 0, jul: 0, aug: 0, sep: 0, oct: 0, nov: 0, dec: 0, jan: null, feb: null, mar: null, total: 1 },
            { id: 7, size: "145/80R12 ULTIMA HILIFE 74T TL", module: "US", apr: 0, may: 0, jun: 0, jul: 0, aug: 0, sep: 0, oct: 2, nov: 0, dec: 0, jan: null, feb: null, mar: null, total: 2 },
            { id: 8, size: "145/80R12 ULTIMA HILIFE TL", module: "2 Stage", apr: 2, may: 1, jun: 2, jul: 2, aug: 1, sep: 1, oct: 0, nov: 1, dec: 0, jan: null, feb: null, mar: null, total: 10 },
            { id: 9, size: "145/80R13 ULT NEO 75S TL", module: "BJ", apr: 1, may: 0, jun: 1, jul: 0, aug: 0, sep: 2, oct: 2, nov: 2, dec: 2, jan: null, feb: null, mar: null, total: 10 },
            { id: 10, size: "155 R13 UL XPC 8PR Q TT", module: "2 Stage", apr: 0, may: 1, jun: 0, jul: 0, aug: 1, sep: 0, oct: 1, nov: 2, dec: 0, jan: null, feb: null, mar: null, total: 5 },
            { id: 11, size: "155/65R13 ULTIMA HL 73T TL", module: "US", apr: 0, may: 0, jun: 0, jul: 0, aug: 0, sep: 0, oct: 0, nov: 1, dec: 0, jan: null, feb: null, mar: null, total: 1 },
            { id: 12, size: "155/70R13 ULT HL 75T TL", module: "US", apr: 0, may: 0, jun: 1, jul: 0, aug: 1, sep: 0, oct: 0, nov: 0, dec: 0, jan: null, feb: null, mar: null, total: 2 },
            { id: 13, size: "155/80R13 TAXIMAX 79S TL", module: "US", apr: 1, may: 0, jun: 1, jul: 1, aug: 2, sep: 1, oct: 1, nov: 0, dec: 2, jan: null, feb: null, mar: null, total: 9 },
            { id: 14, size: "155/80R13 UL HL 79S TL", module: "US", apr: 0, may: 1, jun: 1, jul: 2, aug: 1, sep: 2, oct: 2, nov: 2, dec: 1, jan: null, feb: null, mar: null, total: 12 },
            { id: 15, size: "155R13 ULTIMA XPC 8PR TL", module: "2 Stage", apr: 2, may: 0, jun: 0, jul: 1, aug: 0, sep: 1, oct: 1, nov: 1, dec: 0, jan: null, feb: null, mar: null, total: 6 },
            { id: 16, size: "165/70R14 Taximax 81S TL", module: "Maxx", apr: 0, may: 1, jun: 1, jul: 1, aug: 1, sep: 1, oct: 2, nov: 1, dec: 0, jan: null, feb: null, mar: null, total: 8 },
            { id: 17, size: "165/70R14 UX Touring 81S TL", module: "Maxx", apr: 0, may: 0, jun: 2, jul: 0, aug: 0, sep: 1, oct: 0, nov: 1, dec: 1, jan: null, feb: null, mar: null, total: 5 },
            { id: 18, size: "165/80R14 TAXIMAX 85S TL", module: "BJ", apr: 1, may: 1, jun: 2, jul: 0, aug: 2, sep: 1, oct: 0, nov: 0, dec: 2, jan: null, feb: null, mar: null, total: 9 },
            { id: 19, size: "165/80R14 UX Royal 85T TL", module: "Maxx", apr: 2, may: 1, jun: 2, jul: 2, aug: 2, sep: 1, oct: 1, nov: 1, dec: 2, jan: null, feb: null, mar: null, total: 14 },
            { id: 20, size: "165/80R14 UX Touring 85S TL", module: "Maxx", apr: 1, may: 0, jun: 0, jul: 0, aug: 1, sep: 2, oct: 0, nov: 1, dec: 0, jan: null, feb: null, mar: null, total: 5 }
        ];

        const cutAnalysisData = [
            { id: 1, parameter: "Overall Tread Center Gauge", specTarget: "14", s1: "14.59", s2: "14.64", s3: "14.6", avg: "14.61", score: "8.00", rating: "B", status: "OK" },
            { id: 2, parameter: "Overall Shoulder Gauge SS", specTarget: "15.5", s1: "16.88", s2: "17.13", s3: "15.6", avg: "16.54", score: "8.00", rating: "B", status: "OK" },
            { id: 3, parameter: "Overall Shoulder Gauge OSS", specTarget: "15.5", s1: "16.39", s2: "16.6", s3: "16.79", avg: "16.59", score: "8.00", rating: "B", status: "OK" },
            { id: 4, parameter: "* Tread Center Rubber Gauge", specTarget: "9.2", s1: "9.93", s2: "9.86", s3: "9.43", avg: "9.74", score: "8.00", rating: "B", status: "OK" },
            { id: 5, parameter: "* Tread shoulder Rubber gauge SS", specTarget: "8.9", s1: "9.09", s2: "9.21", s3: "8.74", avg: "9.01", score: "9.00", rating: "A", status: "OK" },
            { id: 6, parameter: "* Tread shoulder Rubber gauge OSS", specTarget: "8.9", s1: "9.31", s2: "9.78", s3: "9.25", avg: "9.45", score: "8.00", rating: "B", status: "OK" },
            { id: 7, parameter: "* Under Tread 1 at Center", specTarget: "2.4", s1: "3.09", s2: "2.8", s3: "2.4", avg: "2.76", score: "8.00", rating: "B", status: "OK" },
            { id: 8, parameter: "Under Tread 2 at Shoulder SS", specTarget: "2.2", s1: "2.77", s2: "2.61", s3: "2.52", avg: "2.63", score: "7.00", rating: "C", status: "ACTION!" },
            { id: 9, parameter: "Under Tread 2 at Shoulder OSS", specTarget: "2.2", s1: "2.77", s2: "2.79", s3: "2.45", avg: "2.67", score: "7.00", rating: "C", status: "ACTION!" },
            { id: 10, parameter: "* Inner Liner gauge at shoulders SS", specTarget: "", s1: "", s2: "", s3: "", avg: "#DIV/0!", score: "10.00", rating: "A", status: "OK" },
            { id: 11, parameter: "* Inner Liner gauge at shoulders OSS", specTarget: "", s1: "", s2: "", s3: "", avg: "#DIV/0!", score: "10.00", rating: "A", status: "OK" },
            { id: 12, parameter: "* Belt 1 Width", specTarget: "90", s1: "88.08", s2: "91.22", s3: "87.89", avg: "89.06", score: "9.00", rating: "A", status: "OK" },
            { id: 13, parameter: "* Belt 2 Width", specTarget: "80", s1: "80", s2: "78.6", s3: "81.66", avg: "80.09", score: "9.00", rating: "A", status: "OK" },
            { id: 14, parameter: "* Belt 1 Centering SS", specTarget: "45", s1: "46.43", s2: "45.14", s3: "44.9", avg: "45.49", score: "10.00", rating: "A", status: "OK" },
            { id: 15, parameter: "* Belt 1 Centering OSS", specTarget: "45", s1: "45.15", s2: "44.4", s3: "42.99", avg: "44.18", score: "10.00", rating: "A", status: "OK" },
            { id: 16, parameter: "* Belt 2 Centering SS", specTarget: "40", s1: "40.36", s2: "40.23", s3: "42.25", avg: "40.95", score: "10.00", rating: "A", status: "OK" },
            { id: 17, parameter: "* Belt 2 Centering OSS", specTarget: "40", s1: "40.09", s2: "39.88", s3: "39.41", avg: "39.79", score: "10.00", rating: "A", status: "OK" },
            { id: 18, parameter: "Half Width of capstrip SS", specTarget: "50", s1: "47.8", s2: "50.02", s3: "48.94", avg: "48.92", score: "10.00", rating: "A", status: "OK" },
            { id: 19, parameter: "Half Width of capstrip OSS", specTarget: "50", s1: "50.48", s2: "49.55", s3: "48.34", avg: "49.46", score: "10.00", rating: "A", status: "OK" },
            { id: 20, parameter: "Pad Gauge SS", specTarget: "2.6", s1: "3.2", s2: "3.13", s3: "2.99", avg: "3.11", score: "9.00", rating: "A", status: "OK" },
            { id: 21, parameter: "Pad Gauge OSS", specTarget: "2.6", s1: "2.57", s2: "2.36", s3: "2.82", avg: "2.58", score: "10.00", rating: "A", status: "OK" },
        ];

        const offParameterReports = [
            {
                month: "Apr'25",
                entries: [
                    { id: 1, size: "120/80R12 ULT XPC 86F TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 2, size: "120/80R12 ULT XPC1 74F TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 3, size: "130/80R12 ULT XPC 90F TL", module: "2 Stage", rating: "A", offParameters: "-", reason: "-" },
                    { id: 4, size: "135/70R12 ULTIMA LXT 65S TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 5, size: "135/70R15 STAR XT", module: "2 Stage", rating: "C", offParameters: "Sh(Total)_UT_Sh & RS_HT", reason: "Tread Profile or Gauges" },
                    { id: 6, size: "145/80R13 ULT NEO TL", module: "BJ", rating: "D", offParameters: "Sh(Total)_Sh(Rubber)", reason: "Tread Profile" },
                ]
            },
            {
                month: "May'25",
                entries: [
                    { id: 1, size: "120/80R12 ULT XPC 74F TL", module: "2 Stage", rating: "C", offParameters: "Pad & Sw Ending", reason: "Sidewall" },
                    { id: 2, size: "145/80R12 Taximax TL", module: "2 Stage", rating: "C", offParameters: "SH(Rubber)_SH(Total)", reason: "Shoulder" },
                    { id: 3, size: "145/80R12 ULTIMA HILIFE TL", module: "2 Stage", rating: "B", offParameters: "Filler Height", reason: "Filler" },
                    { id: 4, size: "145/80R13 UL HL TL", module: "US", rating: "B", offParameters: "-", reason: "-" },
                    { id: 5, size: "165/70R14 Taximax TL", module: "Maxx", rating: "B", offParameters: "Ply_W", reason: "Ply Width" },
                ]
            },
            {
                month: "Jun'25",
                entries: [
                    { id: 1, size: "120/80R12 ULT XPC 86F TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 2, size: "130/80R12 ULT XPC1 74F TL", module: "2 Stage", rating: "A", offParameters: "-", reason: "-" },
                    { id: 3, size: "145/80R12 ULTIMA HILIFE TL", module: "2 Stage", rating: "C", offParameters: "CL(Rubber), UT_CL & H", reason: "Tread" },
                    { id: 4, size: "155/70R13 ULT HL 75T TL", module: "US", rating: "C", offParameters: "UT_CL/T_S H & RS_HT", reason: "Tread & Sidewall" },
                    { id: 5, size: "165/70R14 Taximax TL", module: "Maxx", rating: "C", offParameters: "Sh(Total) & SW Ending", reason: "Tread & Sidewall" },
                ]
            },
            {
                month: "Jul'25",
                entries: [
                    { id: 1, size: "120/80R12 ULT XPC 74F TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 2, size: "145/80R12 ULTIMA HILIFE 74T TL", module: "2 Stage", rating: "B", offParameters: "-", reason: "-" },
                    { id: 3, size: "155/80R13 ULTIMA HILIFE TL", module: "US", rating: "C", offParameters: "Sh(Rubber)", reason: "Tread" },
                ]
            }
        ];
        const MonthlyCount = () => (
            <div className="flex flex-col h-full">
                <div className="flex justify-between items-center mb-4 px-1">
                    <h3 className="font-bold text-gray-800 flex items-center gap-2"><TableIcon className="w-4 h-4 text-blue-600" />Monthly Production Count</h3>
                    <div className="flex gap-2">
                        <input type="text" placeholder="Search..." className="px-2 py-1.5 text-xs border rounded-lg" />
                        <button className="px-3 py-1.5 bg-green-600 text-white rounded-lg text-xs font-medium flex items-center gap-1"><Download className="w-3.5 h-3.5" /> Export</button>
                    </div>
                </div>
                <div className="flex-1 overflow-auto border border-gray-200 rounded-lg bg-white shadow-sm">
                    <table className="w-full text-xs text-left border-collapse">
                        <thead className="bg-gray-50 sticky top-0 z-10 shadow-sm">
                            <tr>
                                <th className="px-3 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-12 bg-gray-50">S.No.</th>
                                <th className="px-3 py-3 font-bold text-gray-600 border-b border-gray-200 min-w-[220px] bg-gray-50">Size</th>
                                <th className="px-3 py-3 font-bold text-gray-600 border-b border-gray-200 w-24 bg-gray-50">Module</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-blue-50/50">APR'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-gray-50">MAY'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-blue-50/50">JUN'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-gray-50">JUL'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-blue-50/50">AUG'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-gray-50">SEP'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-blue-50/50">OCT'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-gray-50">NOV'25</th>
                                <th className="px-2 py-3 font-bold text-gray-600 border-b border-gray-200 text-center w-14 bg-blue-50/50">DEC'25</th>
                                <th className="px-2 py-3 font-semibold text-gray-400 border-b border-gray-200 text-center w-14 bg-gray-50">JAN'26</th>
                                <th className="px-2 py-3 font-semibold text-gray-400 border-b border-gray-200 text-center w-14 bg-gray-50">FEB'26</th>
                                <th className="px-2 py-3 font-semibold text-gray-400 border-b border-gray-200 text-center w-14 bg-gray-50">MAR'26</th>
                                <th className="px-3 py-3 font-bold text-gray-800 border-b border-gray-200 text-center w-16 bg-gray-100 sticky right-0 shadow-[-4px_0_8px_-4px_rgba(0,0,0,0.1)]">Total</th>
                            </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-100">
                            {monthlyCountData.map((row) => (
                                <tr key={row.id} className="hover:bg-blue-50/50 transition-colors">
                                    <td className="px-3 py-2 text-center text-gray-500">{row.id}</td>
                                    <td className="px-3 py-2 font-medium text-gray-700">{row.size}</td>
                                    <td className="px-3 py-2 text-gray-600">{row.module}</td>
                                    <td className="px-2 py-2 text-center bg-blue-50/10">{row.apr}</td>
                                    <td className="px-2 py-2 text-center">{row.may}</td>
                                    <td className="px-2 py-2 text-center bg-blue-50/10">{row.jun}</td>
                                    <td className="px-2 py-2 text-center">{row.jul}</td>
                                    <td className="px-2 py-2 text-center bg-blue-50/10">{row.aug}</td>
                                    <td className="px-2 py-2 text-center">{row.sep}</td>
                                    <td className="px-2 py-2 text-center bg-blue-50/10">{row.oct}</td>
                                    <td className="px-2 py-2 text-center">{row.nov}</td>
                                    <td className="px-2 py-2 text-center bg-blue-50/10">{row.dec}</td>
                                    <td className="px-2 py-2 text-center text-gray-300">{row.jan !== null ? row.jan : ''}</td>
                                    <td className="px-2 py-2 text-center text-gray-300">{row.feb !== null ? row.feb : ''}</td>
                                    <td className="px-2 py-2 text-center text-gray-300">{row.mar !== null ? row.mar : ''}</td>
                                    <td className="px-2 py-2 text-center font-bold bg-gray-50 sticky right-0">{row.total}</td>
                                </tr>
                            ))}
                        </tbody>
                        <tfoot className="bg-gray-100 sticky bottom-0 font-bold text-gray-800 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] border-t-2 border-gray-300">
                            <tr>
                                <td colSpan={3} className="px-4 py-3 text-right">Grand Total:</td>
                                <td className="px-2 py-3 text-center">39</td>
                                <td className="px-2 py-3 text-center">22</td>
                                <td className="px-2 py-3 text-center">39</td>
                                <td className="px-2 py-3 text-center">23</td>
                                <td className="px-2 py-3 text-center">36</td>
                                <td className="px-2 py-3 text-center">40</td>
                                <td className="px-2 py-3 text-center">35</td>
                                <td className="px-2 py-3 text-center">41</td>
                                <td className="px-2 py-3 text-center">39</td>
                                <td className="px-2 py-3 text-center text-gray-400">0</td>
                                <td className="px-2 py-3 text-center text-gray-400">0</td>
                                <td className="px-2 py-3 text-center text-gray-400">0</td>
                                <td className="px-2 py-3 text-center bg-gray-200 sticky right-0 shadow-[-4px_0_8px_-4px_rgba(0,0,0,0.1)]">315</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        );

        const CutAnalysis = () => (
            <div className="flex flex-col h-full">
                <div className="flex justify-between items-center mb-4 px-1">
                     <div className="flex items-center gap-3">
                        <div className="flex items-center gap-2 px-3 py-1.5 bg-white border border-gray-300 rounded-lg shadow-sm">
                            <CalendarIcon className="w-4 h-4 text-blue-600" />
                            <select className="text-sm font-semibold text-gray-700 bg-transparent outline-none cursor-pointer">
                                <option>September 2025</option>
                                <option>August 2025</option>
                                <option>July 2025</option>
                            </select>
                        </div>
                        <div className="h-6 w-px bg-gray-300 mx-1"></div>
                        <div className="flex items-center gap-2">
                            <span className="text-xs font-medium text-gray-500 uppercase tracking-wide">Recipe:</span>
                            <select className="pl-2 pr-8 py-1.5 bg-white border border-gray-300 rounded-lg text-sm font-bold text-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all min-w-[280px] shadow-sm">
                                <option>120/80R12 ULT XPC1 74F TL</option>
                                <option>145/80R12 Taximax TL</option>
                                <option>155/80R13 Taximax TL</option>
                            </select>
                        </div>
                     </div>
                     <div className="flex gap-2">
                        <button className="px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded-lg text-xs font-medium hover:bg-gray-50 flex items-center gap-1 shadow-sm transition-colors">
                            <Printer className="w-3.5 h-3.5" /> Print
                        </button>
                        <button className="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 flex items-center gap-1 shadow-sm transition-colors">
                            <Download className="w-3.5 h-3.5" /> PDF
                        </button>
                     </div>
                </div>
                <div className="flex-1 overflow-auto bg-gray-100/50 rounded-lg border border-gray-200 p-4">
                    <div className="min-w-[1000px] max-w-[1200px] mx-auto bg-white shadow-lg border border-gray-300 text-[10px] leading-tight font-sans">
                        {/* Header Section */}
                        <div className="bg-blue-900 text-white p-1 text-center font-bold text-lg border-b border-white">
                            <div className="flex justify-between items-center px-4">
                                <span className="italic text-yellow-400 font-black text-xl tracking-tighter">JKTYRE</span>
                                <span>PCR - SECTION ANALYSIS REPORT</span>
                                <div className="text-[9px] text-right leading-3 font-normal">
                                    <div>Format No: CORP/TECH/P/J001</div>
                                    <div>Date: 17-09-2025</div>
                                </div>
                            </div>
                        </div>

                        {/* Top Info Grid */}
                        <div className="grid grid-cols-12 border-b-2 border-black text-black">
                            {/* Left Col */}
                            <div className="col-span-3 border-r border-gray-400">
                                {[
                                    { label: 'TYRE SIZE :', value: '120/80R12 ULT XPC1 74F TL', bold: true },
                                    { label: 'Tyre Code:', value: '120/80R12' },
                                    { label: 'Construction:', value: '' },
                                    { label: 'Location Plant:', value: 'BTP', bold: true },
                                    { label: 'Load Index:', value: '74', bold: true },
                                    { label: 'Speed Rating:', value: 'F', bold: true },
                                    { label: 'OE/REP:', value: 'OE', bold: true },
                                ].map((item, idx) => (
                                    <div key={idx} className="grid grid-cols-3 border-b border-gray-300 last:border-0">
                                        <div className="bg-blue-700 text-white p-1 font-semibold col-span-1">{item.label}</div>
                                        <div className={`col-span-2 p-1 text-center ${item.bold ? 'font-bold' : ''}`}>{item.value}</div>
                                    </div>
                                ))}
                            </div>

                            {/* Middle Col */}
                            <div className="col-span-4 border-r border-gray-400">
                                <div className="grid grid-cols-4 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold col-span-1">Pattern:</div><div className="col-span-2 p-1 font-bold text-center border-r border-gray-300">ULT XPC1</div><div className="col-span-1 text-center font-bold bg-white flex items-center justify-center">TBM</div></div>
                                <div className="grid grid-cols-4 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold col-span-1">Mfg.spec No.</div><div className="col-span-2 p-1 text-center border-r border-gray-300"></div><div className="col-span-1 text-center font-bold bg-white row-span-2 flex items-center justify-center">IRM</div></div>
                                <div className="grid grid-cols-4 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold col-span-1">Design No :</div><div className="col-span-2 p-1 text-center border-r border-gray-300"></div></div>
                                <div className="grid grid-cols-4 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold col-span-1">Tread ID:</div><div className="col-span-3 p-1 text-center font-bold">1R</div></div>

                                {/* Category Table embedded */}
                                <div className="grid grid-cols-5 bg-blue-800 text-white text-center border-b border-gray-300">
                                    <div className="col-span-1 p-0.5 border-r border-blue-600">Category</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-600">A</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-600">B</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-600">C</div>
                                    <div className="col-span-1 p-0.5">D</div>
                                </div>
                                <div className="grid grid-cols-5 text-center bg-blue-600 text-white border-b border-gray-300">
                                    <div className="col-span-1 p-0.5 border-r border-blue-500 text-[9px]">Critical Parameter</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">15</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">4</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">0</div>
                                    <div className="col-span-1 p-0.5">0</div>
                                </div>
                                <div className="grid grid-cols-5 text-center bg-blue-600 text-white">
                                    <div className="col-span-1 p-0.5 border-r border-blue-500 text-[9px]">Non-Critical Para.</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">13</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">5</div>
                                    <div className="col-span-1 p-0.5 border-r border-blue-500">2</div>
                                    <div className="col-span-1 p-0.5">0</div>
                                </div>
                            </div>

                            {/* Right Col */}
                            <div className="col-span-5">
                                <div className="grid grid-cols-12 h-full">
                                    <div className="col-span-6 border-r border-gray-400">
                                        <div className="grid grid-cols-2 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold">Mould No :</div><div className="p-1 text-center">GC-02</div></div>
                                        <div className="grid grid-cols-2 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold">Tyre weight:</div><div className="p-1 text-center">14.77</div></div>
                                        <div className="grid grid-cols-2 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold">Barcode :</div><div className="p-1 text-center">1046891088</div></div>
                                        <div className="grid grid-cols-2 border-b border-gray-300"><div className="bg-blue-700 text-white p-1 font-semibold">Week code:</div><div className="p-1 text-center">4825</div></div>
                                    </div>
                                    <div className="col-span-3 bg-[#92d050] border-r border-gray-400 flex flex-col items-center justify-center">
                                        <div className="text-white font-bold bg-purple-700 w-full text-center py-0.5 mb-1">TYRE GRADE</div>
                                        <div className="text-5xl font-black text-black">B</div>
                                    </div>
                                    <div className="col-span-3 bg-[#00b050] flex flex-col items-center justify-center">
                                        <div className="text-white font-bold bg-purple-700 w-full text-center py-0.5 mb-1">TYRE RATING</div>
                                        <div className="text-xl font-bold text-black">91.19%</div>
                                    </div>
                                </div>
                                <div className="bg-[#92d050] border-t border-gray-400 text-center font-bold text-lg py-1">
                                    GOOD
                                </div>
                            </div>
                        </div>

                        {/* Main Table */}
                        <table className="w-full border-collapse border border-gray-400">
                            <thead>
                                <tr className="bg-blue-900 text-white text-center">
                                    <th className="border border-gray-400 py-1 w-8">Sr No</th>
                                    <th className="border border-gray-400 py-1 text-left px-2">Parameters</th>
                                    <th className="border border-gray-400 py-1 w-12 bg-yellow-600/50 text-yellow-100">Spec Target</th>
                                    <th className="border border-gray-400 py-1 w-16">Section 1</th>
                                    <th className="border border-gray-400 py-1 w-16">Section 2</th>
                                    <th className="border border-gray-400 py-1 w-16">Section 3</th>
                                    <th className="border border-gray-400 py-1 w-16 bg-blue-800">Average</th>
                                    <th className="border border-gray-400 py-1 w-12 bg-blue-800">Score</th>
                                    <th className="border border-gray-400 py-1 w-12 bg-blue-800">RATING</th>
                                    <th className="border border-gray-400 py-1 w-20 bg-blue-800">STATUS</th>
                                </tr>
                            </thead>
                            <tbody className="text-center font-medium text-gray-800">
                                {cutAnalysisData.map(row => {
                                    let rowClass = "hover:bg-gray-50";
                                    let targetClass = "bg-orange-100";
                                    let statusClass = "bg-purple-500 text-white font-bold text-[9px]";

                                    if (row.status === 'ACTION!') {
                                        rowClass = "bg-white";
                                        statusClass = "bg-red-600 text-white font-bold text-[9px]";
                                    } else if (row.parameter.includes('*')) {
                                        rowClass = "bg-yellow-50";
                                    }

                                    if (row.avg === '#DIV/0!') {
                                        rowClass = "bg-yellow-50";
                                    }

                                    return (
                                        <tr key={row.id} className={rowClass}>
                                            <td className="border border-gray-300 py-0.5">{row.id}</td>
                                            <td className={`border border-gray-300 px-2 text-left ${row.parameter.includes('*') ? 'font-bold' : ''}`}>{row.parameter}</td>
                                            <td className={`border border-gray-300 ${targetClass}`}>{row.specTarget}</td>
                                            <td className={`border border-gray-300 ${row.s1 === '3.09' ? 'text-red-600 font-bold bg-red-50' : ''}`}>{row.s1}</td>
                                            <td className="border border-gray-300">{row.s2}</td>
                                            <td className="border border-gray-300">{row.s3}</td>
                                            <td className="border border-gray-300 bg-blue-50">{row.avg}</td>
                                            <td className="border border-gray-300 bg-blue-50">{row.score}</td>
                                            <td className="border border-gray-300 bg-blue-50 font-bold">{row.rating}</td>
                                            <td className={`border border-gray-300 ${statusClass}`}>{row.status}</td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>

                        {/* Footer Section */}
                        <div className="grid grid-cols-12 border-x border-b border-gray-400 bg-blue-800 text-white text-center font-semibold">
                            <div className="col-span-3 border-r border-gray-400 grid grid-rows-3 text-left">
                                <div className="border-b border-gray-400 px-2 py-0.5">Checked By <span className="float-right font-normal">Piyush Tiwari</span></div>
                                <div className="border-b border-gray-400 px-2 py-0.5">Verified By <span className="float-right font-normal">Neeraj Saxena</span></div>
                                <div className="px-2 py-0.5 bg-blue-900">Tire Disposition <span className="float-right font-bold text-yellow-300">RELEASE</span></div>
                            </div>
                            <div className="col-span-3 border-r border-gray-400 flex flex-col justify-center">
                                <div className="border-b border-gray-400 py-0.5">Remarks</div>
                                <div className="flex-1 py-1"></div>
                            </div>
                            <div className="col-span-3 border-r border-gray-400 flex flex-col justify-center">
                                <div className="border-b border-gray-400 py-0.5">Action Plan</div>
                                <div className="flex-1 py-1"></div>
                            </div>
                            <div className="col-span-3 bg-blue-900 flex flex-col justify-between">
                                <div className="border-b border-gray-400 py-0.5">Revision</div>
                                <div className="text-xl font-bold py-1">08</div>
                                <div className="text-[9px] pb-0.5">14.09.2025</div>
                            </div>
                        </div>

                        {/* Signatories */}
                        <div className="grid grid-cols-4 text-center text-white bg-blue-700 border-x border-b border-gray-400 font-medium">
                            <div className="border-r border-gray-400 py-1">
                                <div className="text-[9px]">Prepared By</div>
                                <div className="font-bold">Pranav/Manoj TR</div>
                                <div className="text-[9px]">DGM-PLT</div>
                            </div>
                            <div className="border-r border-gray-400 py-1">
                                <div className="text-[9px]">Reviewed By</div>
                                <div className="font-bold">Bala C</div>
                                <div className="text-[9px]">CGM-PLT</div>
                            </div>
                            <div className="border-r border-gray-400 py-1">
                                <div className="text-[9px]">Approved By</div>
                                <div className="font-bold">Shaji Varghese</div>
                                <div className="text-[9px]">VP-Corporate Process Technology</div>
                            </div>
                            <div className="bg-blue-900 font-bold flex items-center justify-center text-yellow-400">
                                MASTER COPY
                            </div>
                        </div>

                        {/* Criteria & Revision History */}
                        <div className="bg-blue-600 text-white text-left px-2 py-1 text-[9px] border-x border-b border-gray-400">
                            <div className="font-bold text-yellow-300">Tyre Rating criteria</div>
                            <div>A-Excellent- Value with in product design tolerance. - For NPD gate clearence</div>
                            <div>B- Acceptable- Value with in process design tolerance limits.</div>
                            <div>C - Need improvement, value out of process tolerance needs re-verification and action to be initiated</div>
                            <div>D - Not Acceptable</div>
                            <div>Note: - Worst rating of critical parameters should consider as overall tyre rating.</div>
                            <div>Note: <span className="text-red-300">*</span> Critical Parameters.</div>
                        </div>
                        <div className="bg-blue-800 text-white text-left px-2 py-1 text-[9px] border-x border-b border-gray-400">
                            <div className="font-bold text-yellow-300">Reaction Plan</div>
                            <div>If rating found D, check one more tyre in the same lot.If D rating is repeating the lot should be held for further dispostion and analysis.</div>
                            <div>If rating found C, Alert message should go to all stake holders, Needs reverification and actions to be initiated.Lot will be released.</div>
                            <div>If rating found A or B, Lot will be released.</div>
                        </div>

                        <div className="border border-gray-400">
                            <div className="font-bold px-2 py-0.5 border-b border-gray-400 bg-gray-50">REVISION HISTORY:</div>
                            <div className="grid grid-cols-12 text-center font-bold border-b border-gray-400 bg-gray-50">
                                <div className="col-span-1 border-r border-gray-400">Rev. No.</div>
                                <div className="col-span-2 border-r border-gray-400">Date</div>
                                <div className="col-span-7 border-r border-gray-400">Change Description</div>
                                <div className="col-span-2">Originator</div>
                            </div>
                            <div className="grid grid-cols-12 text-center text-[9px]">
                                <div className="col-span-1 border-r border-gray-300 py-1">7</div>
                                <div className="col-span-2 border-r border-gray-300 py-1">27.09.2024</div>
                                <div className="col-span-7 border-r border-gray-300 py-1 text-left px-1">1. New parameters added - rubber gauge at bead area and under bead area...</div>
                                <div className="col-span-2 py-1">Corporate Process Technology - PLT</div>
                            </div>
                            <div className="grid grid-cols-12 text-center text-[9px] border-t border-gray-300">
                                <div className="col-span-1 border-r border-gray-300 py-1">8</div>
                                <div className="col-span-2 border-r border-gray-300 py-1">14.09.2025</div>
                                <div className="col-span-7 border-r border-gray-300 py-1 text-left px-1">Format updated as per revised SOP ( CORP/TECH/P/H027 â€“ Rev 01) to accommodate 3 section analysis.</div>
                                <div className="col-span-2 py-1">Corporate Process Technology - PLT</div>
                            </div>
                        </div>

                        <div className="bg-gray-800 text-yellow-300 text-[9px] p-1 flex justify-between">
                            <div><span className="font-bold">Distribution:</span> Master Copy: MR-R</div>
                            <div>Controlled Copy: Hard Copy - HOD (SSU # 2), Incharge (Process owner)</div>
                        </div>

                    </div>
                </div>
            </div>
        );

        const OffParameterReport = () => (
            <div className="flex flex-col h-full">
                <div className="flex justify-between items-center mb-4 px-1"><h3 className="font-bold">Off-Parameter Report</h3></div>
                <div className="flex-1 overflow-x-auto bg-gray-50 border border-gray-200 rounded-lg p-2 flex gap-4">
                    {offParameterReports.map((report, i) => (
                        <div key={i} className="w-[530px] bg-white flex flex-col h-full flex-shrink-0 border border-gray-300 rounded shadow-sm">
                            <div className="p-3 border-b border-gray-200 bg-blue-50 font-bold text-blue-800 text-xs text-center uppercase tracking-wide sticky top-0">
                                CTA Report - {report.month}
                            </div>
                            <div className="flex-1 overflow-y-auto">
                                <table className="w-full text-[10px] text-left">
                                    <thead className="bg-gray-50 text-gray-500 border-b border-gray-200 font-semibold sticky top-0">
                                        <tr>
                                            <th className="p-2 w-8 text-center">S.No</th>
                                            <th className="p-2 w-32">Size</th>
                                            <th className="p-2 w-12">Module</th>
                                            <th className="p-2 w-10 text-center">Rating</th>
                                            <th className="p-2 w-20">Off Parameter(s)</th>
                                            <th className="p-2 w-20">Reason(s)</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-100">
                                        {report.entries.map((entry, j) => {
                                            let ratingBg = "bg-gray-100 text-gray-700";
                                            if(entry.rating === 'A') ratingBg = "bg-green-100 text-green-700";
                                            if(entry.rating === 'B') ratingBg = "bg-yellow-100 text-yellow-700";
                                            if(entry.rating === 'C') ratingBg = "bg-orange-100 text-orange-700";
                                            if(entry.rating === 'D') ratingBg = "bg-red-100 text-red-700";

                                            return (
                                                <tr key={j}>
                                                    <td className="p-2 text-center text-gray-400">{j + 1}</td>
                                                    <td className="p-2 font-medium">{entry.size}</td>
                                                    <td className="p-2">{entry.module}</td>
                                                    <td className="p-2 text-center">
                                                        <span className={`px-1.5 py-0.5 rounded font-bold ${ratingBg}`}>{entry.rating}</span>
                                                    </td>
                                                    <td className={`p-2 font-medium ${entry.offParameters !== '-' ? 'text-red-600' : 'text-gray-400'}`}>
                                                        {entry.offParameters}
                                                    </td>
                                                    <td className={`p-2 ${entry.reason !== '-' ? '' : 'text-gray-400'}`}>{entry.reason}</td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const DataComparison = () => {
            const [activeTab, setActiveTab] = useState('monthly-count');
            return (
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 min-h-[600px] flex flex-col h-[calc(100vh-130px)]">
                    <div className="border-b border-gray-200">
                        <nav className="flex space-x-8 px-6">
                            <button onClick={() => setActiveTab('monthly-count')} className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${activeTab === 'monthly-count' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}><CalendarRange className="w-4 h-4" /> Monthly Count</button>
                            <button onClick={() => setActiveTab('cut-analysis')} className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${activeTab === 'cut-analysis' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}><Scissors className="w-4 h-4" /> Cut Analysis</button>
                            <button onClick={() => setActiveTab('off-parameter')} className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${activeTab === 'off-parameter' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`}><AlertTriangle className="w-4 h-4" /> Off-Parameter</button>
                        </nav>
                    </div>
                    <div className="p-6 flex-1 bg-gray-50/50 relative overflow-hidden flex flex-col">
                        {activeTab === 'monthly-count' && <MonthlyCount />}
                        {activeTab === 'cut-analysis' && <CutAnalysis />}
                        {activeTab === 'off-parameter' && <OffParameterReport />}
                    </div>
                </div>
            );
        };

        let dataComparisonMounted = false;
        window.mountDataComparison = function() {
            if (dataComparisonMounted) return;
            const root = ReactDOM.createRoot(document.getElementById('data-comparison-root'));
            root.render(<DataComparison />);
            dataComparisonMounted = true;
        }
    </script>
</body>
</html>
